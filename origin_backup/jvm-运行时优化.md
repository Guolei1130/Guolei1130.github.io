## Java的内存模型

java虚拟机规范中定义了一种内存模型来屏蔽各种硬件和操作系统内存访问差异。

#### 主内存和工作内存 

![](http://images2015.cnblogs.com/blog/641003/201607/641003-20160725173058231-119984971.jpg)


内存模型中规定，所有的变量都存在主内存当中，但是每个线程还有自己的工作内存，线程对变量的操作都在自己的工作内存当中。

#### 内存间交互操作

以下操作都是原子操作。

* lock 锁定，作用于主内存中的变量，把一个变量标识为线程独占的状态
* unlock 解锁，作用于主内存中的变量，从独占状态释放出来
* read 读取，作用于主内存中的变量，从主内存传输到工作内存
* load 载入，作用于工作内存，将read操作的值放入到工作内存中
* use 使用，
* assign 赋值，从执行引擎收到的值传给工作内存中的变量
* store 存储，传送到主内存中
* write 写入，放入到主内存中的变量中

#### volatile的特殊规则

volatile这里不多说，volatile具有以下特性：

* 内存可见性
* 防止指令集重排

